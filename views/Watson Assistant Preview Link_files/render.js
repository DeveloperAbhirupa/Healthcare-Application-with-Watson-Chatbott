/*!
 * 
 * (C) Copyright IBM Corp. 2017 - 2019. All Rights Reserved.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 * 
 * watson-web-channel 0.1.2
 * Contributors: Ethan Winters, Raymond Chu, Karen Harris, Ashley Lord, Amy Zhong, Ryan Simpson, Anthony Wong, Wilson Wong, David G Terry, Simon Burns, Damon Lundin, John Engstrom, Neil Mallinar
 * Built: Sep 12 2019 2:03 pm +00:00
 * 
 * 
 */
(window.webpackJsonpWatsonAssistantChat=window.webpackJsonpWatsonAssistantChat||[]).push([[48],{727:function(e,t,n){"use strict";function a(e){}n.d(t,"a",function(){return a})},936:function(e,t,n){"use strict";n.r(t);var a,r,o=n(1),s=n.n(o),i=n(740),c=n.n(i),l=n(718),u=n(741),p=n(745),m=n(46),g=n.n(m),_=n(47),f=n.n(_),d=(n(837),n(716)),h=n(71),v=n.n(h),C=n(719),E=n(306),y=s.a.createContext(null),A=n(12),b=n.n(A),w=function(){return(w=b.a||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},W=function(e){return s.a.createElement("svg",{viewBox:"0 0 28 26",xmlns:"http://www.w3.org/2000/svg",focusable:"false","aria-hidden":"true"},s.a.createElement("defs",null,s.a.createElement("path",{d:"M17.74,30 L16,29 L20,22 L26,22 C27.1045695,22 28,21.1045695 28,20 L28,8 C28,6.8954305 27.1045695,6 26,6 L6,6 C4.8954305,6 4,6.8954305 4,8 L4,20 C4,21.1045695 4.8954305,22 6,22 L15,22 L15,24 L6,24 C3.790861,24 2,22.209139 2,20 L2,8 C2,5.790861 3.790861,4 6,4 L26,4 C28.209139,4 30,5.790861 30,8 L30,20 C30,22.209139 28.209139,24 26,24 L21.16,24 L17.74,30 Z M8,10 L24,10 L24,12 L8,12 L8,10 Z M8,16 L18,16 L18,18 L8,18 L8,16 Z",id:"path-2"})),s.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},s.a.createElement("g",{transform:"translate(-2.000000, -4.000000)"},s.a.createElement("mask",{fill:"none"},s.a.createElement("use",{xlinkHref:"#path-2"})),s.a.createElement("use",w({},e,{xlinkHref:"#path-2"})))))},N=n(223),T=(a=function(e,t){return(a=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?g()(t):(n.prototype=t.prototype,new n)});!function(e){e.GRAY="gray-variation",e.BLUE="blue-variation"}(r||(r={}));var k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonRef=s.a.createRef(),t.requestFocus=function(){t.buttonRef.current&&t.buttonRef.current.focus()},t.toggleLauncher=function(){var e=t.props,n=e.isOpen;(0,e.onToggleOpen)(),t.props.actions.track({eventName:"Widget_"+(n?"closes":"opens"),eventDescription:"user "+(n?"closed":"opened")+" the widget",method:"launcher"})},t.renderButton=function(e){var n=t.props,a=n.uuid,r=n.isOpen,o=n.languagePack,i=n.unreadAgentCount,c=n.intl,l=r?o.launcher_isOpen:o.launcher_isClosed;return 0!==i&&(l+=". "+c.formatMessage({id:"icon_ariaUnreadMessages"},{count:i})),s.a.createElement("button",{"aria-label":l,className:"WACLauncher__Button WACLauncher__Button--"+e+" WACLauncher--"+a,id:"WACLauncher__Button",type:"button",onClick:t.toggleLauncher,ref:t.buttonRef},s.a.createElement(W,{className:v()("WACLauncher__svg",{"WACLauncher__svg--open":r})}),0!==i&&s.a.createElement("div",{className:"WAC__countIndicator"},i))},t}return T(t,e),t.prototype.componentDidMount=function(){var e=this.context.optimizely;Object(N.b)(e,"LAUNCHER_COLOR",this.props.actions,{eventName:"Launcher_renders",eventDescription:"The launcher button is rendered."})},t.prototype.render=function(){return s.a.createElement(u.OptimizelyExperiment,{experiment:"LAUNCHER_COLOR"},s.a.createElement(u.OptimizelyVariation,{variation:r.GRAY},this.renderButton(r.GRAY)),s.a.createElement(u.OptimizelyVariation,{variation:r.BLUE},this.renderButton(r.BLUE)),s.a.createElement(u.OptimizelyVariation,{default:!0},this.renderButton("default")))},t.contextType=y,t}(o.PureComponent),P=Object(d.injectIntl)(k,{forwardRef:!0}),O=n(733),R=n.n(O),S=function(e){return s.a.createElement("svg",{width:"17",height:"14",viewBox:"0 0 17 14",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",focusable:"false","aria-hidden":"true"},s.a.createElement("defs",null,s.a.createElement("polygon",{id:"send-icon-polygon",points:"11.25 3.75 10.36875 4.63125 15.10625 9.375 1.875 9.375 1.875 10.625 15.10625 10.625 10.36875 15.36875 11.25 16.25 17.5 10"})),s.a.createElement("g",{fill:"none",fillRule:"evenodd"},s.a.createElement("g",{id:"Theme:-gray-10-/-chatbot-/-text-input-/-regular-/-01-enabled",transform:"translate(-367 -17)"},s.a.createElement("g",{id:"icon/navigation/arrow/right/20",transform:"translate(366 14)"},s.a.createElement("mask",{id:"mask-2"},s.a.createElement("use",{xlinkHref:"#send-icon-polygon"})),s.a.createElement("use",{xlinkHref:"#send-icon-polygon"})))))},L=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.textAreaRef=s.a.createRef(),t}return L(t,e),t.prototype.takeFocus=function(){this.textAreaRef.current.focus()},t.prototype.render=function(){var e=this.props,t=e.isRequired,n=e.name,a=e.id,r=e.onBlur,o=e.onChange,i=e.onKeyDown,c=e.rows,l=e.value,u=e.autoSize,p=e.maxLength,m=e.disabled,g=e.placeholder,_=e.ariaLabel;return s.a.createElement("div",{className:v()("WAC__TextArea",{"WAC__TextArea--autoSize":u,"WAC__TextArea--disabled":m})},s.a.createElement("textarea",{ref:this.textAreaRef,"aria-label":_,"aria-required":t,className:"WAC__TextArea-textarea",disabled:m,id:a,maxLength:p,name:n,onBlur:r,onChange:o,onKeyDown:i,placeholder:g,rows:c,value:l||""}),u&&s.a.createElement("div",{className:"WAC__TextArea-sizer"},l||" "))},t.defaultProps={isRequired:!1,maxLength:1e4},t}(o.PureComponent),x=n(43),I=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={inputValue:"",enableFadeOut:!1},t.textAreaRef=s.a.createRef(),t.onSendBotInput=function(e){if(e.length>0){var n=Object(x.b)(e);t.props.actions.send(n,{trackEventProps:{eventName:"User_gives_dialog_input",eventDescription:"dialog event for user giving input to bot",responseType:"text"}})}},t.onKeyDown=function(e){"Enter"===e.key&&t.send(e)},t.onChange=function(e){t.setState({inputValue:e.target.value,enableFadeOut:!0})},t.send=function(e){var n=t.state.inputValue;e.preventDefault();var a=R()(n).call(n);a.length>0&&(t.props.onSendInput(a),t.setState({inputValue:""}))},t}return I(t,e),t.prototype.takeFocus=function(){this.textAreaRef.current.takeFocus()},t.prototype.render=function(){var e=this.props,t=e.disabled,n=e.languagePack,a=n.input_buttonLabel,r=n.input_ariaInputLabel,o=n.input_placeholder,i=this.state,c=i.inputValue,l=i.enableFadeOut,u=t?"":c,p=!c||t,m=t?void 0:o;return s.a.createElement("div",{id:"WAC__inputContainer",className:"WAC__inputContainer"},s.a.createElement("label",{id:"WAC__inputLabel",className:"WAC__inputLabel","aria-hidden":"true"},o),s.a.createElement("div",{id:"WAC__inputContainer-TextAreaContainer",className:"WAC__inputContainer-TextAreaContainer"},s.a.createElement(M,{autoSize:!0,ariaLabel:r,disabled:t,maxLength:300,onChange:this.onChange,onKeyDown:this.onKeyDown,placeholder:m,value:u,ref:this.textAreaRef,id:"WAC__inputContainer-TextArea"}),s.a.createElement("button",{className:v()({"WAC__send-button WAC__button--base WAC__button--primary disabled":!u,"WAC__send-button WAC__button--base WAC__button--primary disabled fade-out":l&&!u,"WAC__send-button WAC__button--base WAC__button--primary ":u}),id:"WAC__send-button",type:"button",onClick:this.send,"aria-label":a,disabled:p},p?s.a.createElement(S,{className:"WAC__send-icon-disabled"}):s.a.createElement(S,{className:"WAC__send-icon"}))))},t}(o.Component),D=n(37),H=n.n(D),F=n(758),U=n.n(F);function j(){return s.a.createElement("span",{"aria-hidden":"true"},s.a.createElement("span",{className:"WAC__loading-ball"}),s.a.createElement("span",{className:"WAC__loading-ball"}),s.a.createElement("span",{className:"WAC__loading-ball"}))}var V=n(122),q=n.n(V),G=n(221);function z(e){var t=e.text;return s.a.createElement("div",null,t)}var Z=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Z(t,e),t.prototype.render=function(){var e=this.props,t=e.title,n=e.actions,a=e.languagePack.process_getStartedButton;return s.a.createElement(o.Fragment,null,s.a.createElement(z,{text:t}),s.a.createElement("div",{className:"WAC__process-launcher"},s.a.createElement("div",{className:"WAC__button-holder"},s.a.createElement(G.a,{boundParameter:"GO",onClick:function(){return n.openProcess(t)}},a))))},t}(o.PureComponent),Y=function(){return(Y=b.a||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},J=function(e){return s.a.createElement("svg",Y({},e,{width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"}),s.a.createElement("defs",null,s.a.createElement("circle",{id:"warning-icon-circle",cx:"12",cy:"12",r:"12"}),s.a.createElement("path",{d:"M11.04,5.14285714 L12.9685714,5.14285714 L12.9685714,14.5714286 L11.04,14.5714286 L11.04,5.14285714 Z M12,19.7142857 C11.2899196,19.7142857 10.7142857,19.1386518 10.7142857,18.4285714 C10.7142857,17.718491 11.2899196,17.1428571 12,17.1428571 C12.7100804,17.1428571 13.2857143,17.718491 13.2857143,18.4285714 C13.2857143,19.1386518 12.7100804,19.7142857 12,19.7142857 Z",id:"warning-icon-symbol"})),s.a.createElement("g",{id:"Redline/Specs",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},s.a.createElement("g",{id:"3-copy-13",transform:"translate(-463.000000, -368.000000)"},s.a.createElement("g",{id:"Group",transform:"translate(463.000000, 368.000000)"},s.a.createElement("mask",{id:"mask-2",fill:"white"},s.a.createElement("use",{xlinkHref:"#warning-icon-circle"})),s.a.createElement("use",{id:"icon-color",fill:"#FDD600",xlinkHref:"#warning-icon-circle"}),s.a.createElement("mask",{id:"mask-4",fill:"white"},s.a.createElement("use",{xlinkHref:"#warning-icon-symbol"})),s.a.createElement("use",{id:"icon-color",fill:"#171717",xlinkHref:"#warning-icon-symbol"})))))};function X(e){var t=e.text;return s.a.createElement("div",{className:"WAC__inlineError"},s.a.createElement("div",{className:"WAC__inlineError--iconHolder"},s.a.createElement(J,{className:"WAC__inlineError--icon"})),s.a.createElement("div",{className:"WAC__inlineError--text"},t))}var Q=n(305),$=n(162),ee=n(304),te=n(308),ne=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ne(t,e),t.prototype.render=function(){var e=this.props,t=e.messageToHuman,n=e.languagePack,a=n.agent_mockTitle,r=n.agent_mockDescription,o=n.agent_mockMessageLabel,i=t?s.a.createElement("span",null,s.a.createElement("br",null),s.a.createElement("br",null),o,s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("em",null,t)):null;return s.a.createElement("div",{className:"WAC__connectToAgent--textHolder WAC__connectToAgent--preview"},s.a.createElement("div",{className:"WAC__connectToAgent--title"},a),s.a.createElement("div",{className:"WAC__connectToAgent--description"},r," ",i))},t}(o.PureComponent),re=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isDisabled:!1},t.onClick=Object($.b)(function(){t.setState({isDisabled:!0}),t.props.actions.humanAgentService.startChat(t.props.localMessage.message),t.props.requestInputFocus()}),t}return re(t,e),t.prototype.render=function(){var e=this.props,t=e.languagePack,n=e.disableUserInputs,a=this.state.isDisabled,r=t.agent_chatTitle,o=t.agent_chatDescription,i=t.agent_startChat,c=n||a;return s.a.createElement("div",{className:"WAC__connectToAgent--textHolder"},s.a.createElement("div",{className:"WAC__connectToAgent--title"},r),s.a.createElement("div",{className:"WAC__connectToAgent--description"},o),s.a.createElement("button",{type:"button",className:"WAC__connectToAgent--link",onClick:this.onClick,disabled:c},s.a.createElement("div",{className:"WAC__connectToAgent--link-text"},i),s.a.createElement(S,{className:"WAC__send-icon"})))},t}(o.PureComponent),se=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return se(t,e),t.prototype.render=function(){var e=this.props,t=e.languagePack,n=e.localMessage,a=e.isPreviewLink,r=e.actions,o=e.agentState,i=e.requestInputFocus,c=n.message.message_to_human_agent,l=n.ui_state.fromHistory||o.isConnected||o.isConnecting;return s.a.createElement("div",{className:"WAC__connectToAgentHolder"},a&&s.a.createElement(ae,{languagePack:t,messageToHuman:c}),!a&&s.a.createElement(oe,{localMessage:n,actions:r,languagePack:t,disableUserInputs:l,requestInputFocus:i}))},t}(o.PureComponent),ce=n(158),le=n(23),ue=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={disableUserInputs:!1},t.onSelect=function(e,n){var a=Object(x.a)(n.item),r={eventName:"User_clicks_on_disambiguation_option",eventDescription:"user clicks on one of the disamb options",position:n.index+1};t.props.actions.send(a,{trackEventProps:r}),t.setState({value:a}),t.props.requestInputFocus()},t}return ue(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.events.once({type:le.a.SEND,handler:function(){e.setState({disableUserInputs:!0})}})},t.prototype.render=function(){var e=this,t=this.props,n=t.suggestions,a=t.title,r=this.state.value,i=this.state.disableUserInputs||this.props.disableUserInputs;return s.a.createElement(o.Fragment,null,s.a.createElement(ce.a,{description:a}),s.a.createElement("div",{className:"WAC__button-holder"},s.a.createElement("ul",null,H()(n).call(n,function(t,n){return s.a.createElement("li",{key:t.label},s.a.createElement(G.a,{boundParameter:{index:n,item:t},id:"WAC__disambigButton-"+n,disabled:i,selected:r&&t.value.input===r.input,onClick:e.onSelect},t.label))}))))},t}(o.Component),me=n(80),ge=n.n(me),_e=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),fe=function(){return(fe=b.a||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},de=function(e){function t(t){var n=e.call(this,t)||this;return n.id=t.uid||ge()(),n.fill="url(#"+n.id+")",n}return _e(t,e),t.prototype.render=function(){return s.a.createElement("svg",fe({},this.props,{fill:"#ffffff"}),s.a.createElement("g",null,s.a.createElement("defs",null,s.a.createElement("linearGradient",{x1:"0",x2:"100%",y1:"0%",y2:"0%"},s.a.createElement("stop",{offset:"0%",stopColor:"white",stopOpacity:"0"}),s.a.createElement("stop",{offset:"30%",stopColor:"white",stopOpacity:"1"}),s.a.createElement("stop",{offset:"60%",stopColor:"white",stopOpacity:"1"}),s.a.createElement("stop",{offset:"100%",stopColor:"white",stopOpacity:"0"})))),s.a.createElement("rect",fe({x:"0",y:"0",transform:"translate(0, 0)"},this.props),s.a.createElement("animate",{attributeType:"XML",attributeName:"x",from:"-100%",to:"100%",dur:"1500ms",repeatCount:"indefinite"})))},t}(o.PureComponent),he=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),ve=function(e){function t(t){var n=e.call(this,t)||this;return n.image=s.a.createRef(),n.state={loaded:!1,error:!1},n}return he(t,e),t.prototype.componentDidMount=function(){var e=this,t=function t(){e.setState({error:!0}),e.image.current&&(e.image.current.removeEventListener("load",n),e.image.current.removeEventListener("error",t))},n=function n(){e.setState({loaded:!0}),e.image.current&&(e.image.current.removeEventListener("load",n),e.image.current.removeEventListener("error",t))};this.image.current.complete?n():this.image.current&&(this.image.current.addEventListener("load",n),this.image.current.addEventListener("error",t))},t.prototype.render=function(){var e=this.props,t=e.imageError,n=e.source,a=e.title,r=e.description,i=this.state,c=i.loaded,l=i.error;return s.a.createElement(o.Fragment,null,!c&&s.a.createElement(o.Fragment,null,l?s.a.createElement(X,{text:t}):s.a.createElement("div",{className:"WAC__imageHolder"},s.a.createElement(de,{className:v()("WAC__image--loading",{"WAC__image--text":a||r,"WAC__image--no-text":!a&&!r})}),(a||r)&&s.a.createElement("div",{className:"WAC__image--textHolder"},a&&s.a.createElement("div",null,s.a.createElement(de,{className:"WAC__image--loading-title"})),r&&s.a.createElement("div",null,s.a.createElement(de,{className:"WAC__image--loading-description"}),s.a.createElement(de,{className:"WAC__image--loading-description"}))))),!l&&s.a.createElement("div",{className:"WAC__imageHolder"},s.a.createElement("img",{className:v()("WAC__image",{"WAC__image--loaded":c,"WAC__image--error":l,"WAC__image--text":a||r,"WAC__image--no-text":!a&&!r}),src:n,alt:a||r||"",ref:this.image,style:{display:c?"block":"none"}}),(a||r)&&c&&s.a.createElement("div",{className:"WAC__image--textHolder"},a&&s.a.createElement("div",{className:"WAC__image--title"},a),r&&s.a.createElement("div",{className:v()("WAC__image--description",{"WAC__image--description-margin":a&&r})},r))))},t}(o.PureComponent),Ce=n(168),Ee=n.n(Ce),ye=n(728),Ae=n.n(ye),be=n(157),we=function(){return(we=b.a||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};var We=function(e){return s.a.createElement("svg",we({},e,{focusable:"false",preserveAspectRatio:"xMidYMid meet",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16","aria-hidden":"true",style:{"will-change":"transform"}}),s.a.createElement("path",{d:"M8 11L3 6l.7-.7L8 9.6l4.3-4.3.7.7z"}))},Ne=function(){return(Ne=b.a||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};var Te=function(e){return s.a.createElement("svg",Ne({},e,{focusable:"false",preserveAspectRatio:"xMidYMid meet",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16","aria-hidden":"true",style:{"will-change":"transform"}}),s.a.createElement("path",{d:"M8 5l5 5-.7.7L8 6.4l-4.3 4.3L3 10z"}))},ke=function(){return(ke=b.a||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Pe=function(e){return s.a.createElement("svg",ke({},e,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"}),s.a.createElement("path",{d:"M19.291 13.698a.75.75 0 0 0-.75.75v7.219a.637.637 0 0 1-.637.637H2.7a.637.637 0 0 1-.637-.637V5.947c0-.352.286-.637.637-.637h6.889a.75.75 0 0 0 0-1.5H2.7A2.14 2.14 0 0 0 .563 5.947v15.72A2.14 2.14 0 0 0 2.7 23.804h15.204a2.14 2.14 0 0 0 2.137-2.137v-7.219a.75.75 0 0 0-.75-.75z"}),s.a.createElement("path",{d:"M23.107.254a.75.75 0 0 0-.287-.058h-8.543a.75.75 0 0 0 0 1.5h6.733L10.811 11.895a.75.75 0 0 0 1.06 1.061l10.2-10.2v6.733a.75.75 0 0 0 1.5 0V.946a.75.75 0 0 0-.464-.692z"}))},Oe=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),Re=function(e){function t(t){var n=e.call(this,t)||this;return n.toggleExpandedState=function(){n.setState(function(e){return{expanded:!e.expanded}})},n.state={expanded:!1},n}return Oe(t,e),t.prototype.render=function(){var e=this.props.searchResult,t=e.body,n=e.title,a=this.props.urlIsValid,r=this.props.languagePack,i=r.showLess,c=r.showMore,l=this.state.expanded;return s.a.createElement("div",{className:"WAC__searchResult--padding"},n&&s.a.createElement("div",{className:"WAC__searchResponseTitle"},s.a.createElement("strong",null,n)),t&&s.a.createElement(o.Fragment,null,s.a.createElement("div",{className:v()("WAC__searchResponseBody",{"WAC__searchResponseBody--full":l})},t),!a&&t.length>100&&s.a.createElement("button",{type:"button",onClick:this.toggleExpandedState,className:"WAC__button--link WAC__searchResponseBody-moreToggle"},s.a.createElement("span",{className:"WAC__searchResponseBody-moreToggle-text"},l?i:c),l?s.a.createElement(Te,{className:"WAC__searchResponseBody-moreToggle-icon"}):s.a.createElement(We,{className:"WAC__searchResponseBody-moreToggle-icon"}))),a&&s.a.createElement(Pe,{className:"WAC__Link-svg"}))},t}(o.PureComponent),Se=n(307);var Le=function(e){var t=e.searchResult,n=e.languagePack,a=t.url,r=a&&Object(Se.b)(a);return r?s.a.createElement("a",{className:"WAC__searchResult",href:a,target:"_blank",rel:"noopener noreferrer"},s.a.createElement(Re,{searchResult:t,urlIsValid:r,languagePack:n})):s.a.createElement("div",{className:"WAC__searchResult WAC__searchResult--disabled"},s.a.createElement(Re,{searchResult:t,urlIsValid:r,languagePack:n}))};var Me=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}();function xe(e,t){var n,a,r=e&&e.result_metadata?e.result_metadata.score:0,o=t&&t.result_metadata?t.result_metadata.score:0;return-((n=r)<(a=o)?-1:n>a?1:0)}var Ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sortedResults=Object(be.a)(function(e){return function(e){var t;return e?Ae()(t=Ee()(e).call(e)).call(t,xe):[]}(e)}),t}return Me(t,e),t.prototype.renderSearchResponses=function(){for(var e=this.sortedResults(this.props.message.results),t=Math.min(e.length,3),n=[],a=0;a<t;a++){var r=e[a];n.push(s.a.createElement("li",{key:a},s.a.createElement(Le,{languagePack:this.props.languagePack,searchResult:r})))}return n},t.prototype.render=function(){var e=this.props,t=e.message,n=e.languagePack,a=t.header,r=t.title,i=this.renderSearchResponses();return s.a.createElement(o.Fragment,null,s.a.createElement("div",{className:"WAC__searchMessage--metablock"},a||r||n.messages_searchResults),s.a.createElement("ul",null,i))},t}(o.PureComponent),Be=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),De=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.customResponse=s.a.createRef(),t}return Be(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.events,n=e.message;t.fire({type:le.a.CUSTOM_RESPONSE,data:{message:n,element:this.customResponse.current}})},t.prototype.render=function(){return s.a.createElement("div",{ref:this.customResponse,className:"WAC__message-customResponse"})},t}(o.Component),He=n(44),Fe=n(127);function Ue(e,t){var n,a=t.ui_state.agentProfile,r=a?a.nickname||a.full_name:null;switch(t.message.response_type){case He.a.AGENT_JOINED:n=r?"agent_agentJoinedName":"agent_agentJoinedNoName";break;case He.a.TRANSFER_TO_AGENT:n=r?"agent_transferring":"agent_transferringNoName";break;case He.a.USER_ENDED_CHAT:n="agent_youEndedChat"}return n&&e.formatMessage({id:n},{personName:r})}var je=Object(d.injectIntl)(function(e){return s.a.createElement(o.Fragment,null,Ue(e.intl,e.message))}),Ve=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ve(t,e),t.isValidType=function(e,t,n){switch(e.message.response_type){case Fe.a.TEXT:case Fe.a.IMAGE:case Fe.a.OPTION:case Fe.a.SUGGESTION:case Fe.a.SEARCH:case He.b.WELCOME:case He.b.INLINE_ERROR:case He.a.AGENT_JOINED:case He.a.TRANSFER_TO_AGENT:case He.a.USER_ENDED_CHAT:return!0;case Fe.a.CONNECT_TO_AGENT:return t||n;default:return!1}},t.prototype.renderSpecificMessage=function(e){var n=this.props,a=n.hasServiceDesk,r=n.isPreviewLink;if(!t.isValidType(e,a,r))return this.renderCustomResponse(e);switch(e.message.response_type){case Fe.a.TEXT:return this.renderText(e);case Fe.a.IMAGE:return this.renderImage(e);case Fe.a.OPTION:return this.renderOption(e);case Fe.a.CONNECT_TO_AGENT:return this.renderConnectToAgent(e);case Fe.a.SUGGESTION:return this.renderSuggestion(e);case Fe.a.SEARCH:return this.renderSearch(e);case He.b.WELCOME:return this.renderWelcome(e);case He.b.INLINE_ERROR:return this.renderInlineError(e);case He.a.AGENT_JOINED:case He.a.TRANSFER_TO_AGENT:case He.a.USER_ENDED_CHAT:return this.renderAgentStatusMessage(e);default:return this.renderCustomResponse(e)}},t.prototype.renderText=function(e){var t=e.history&&e.history.label?e.history.label:e.message.text;return"input"===e.ui_state.type?s.a.createElement("div",null,t):s.a.createElement(ee.a,{text:t})},t.prototype.renderOption=function(e){var t=this.props,n=t.languagePack,a=t.requestInputFocus,r=t.actions,o=t.events,i=e.ui_state.fromHistory;return s.a.createElement(te.a,{languagePack:n,options:e.message.options,title:e.message.title,description:e.message.description,events:o,disableUserInputs:i,preference:e.message.preference,requestInputFocus:a,actions:r})},t.prototype.renderSuggestion=function(e){var t=this.props,n=t.requestInputFocus,a=t.actions,r=t.events,o=e.ui_state.fromHistory;return s.a.createElement(pe,{actions:a,events:r,suggestions:e.message.suggestions,title:e.message.title,disableUserInputs:o,requestInputFocus:n})},t.prototype.renderImage=function(e){var t=this.props.languagePack;return s.a.createElement(ve,{imageError:t.errors_imageSource,source:e.message.source,title:e.message.title,description:e.message.description})},t.prototype.renderSearch=function(e){return s.a.createElement(Ie,{message:e.message,languagePack:this.props.languagePack})},t.prototype.renderInlineError=function(e){return s.a.createElement(X,{text:e.message.text})},t.prototype.renderAgentStatusMessage=function(e){return s.a.createElement(je,{message:e})},t.prototype.renderCustomResponse=function(e){var t=this.props.events;return s.a.createElement(De,{message:e.message,events:t})},t.prototype.renderWelcome=function(e){var t,n=this,a=this.props.isPreviewLink;return s.a.createElement("div",{className:"WAC__received--welcome-items"},H()(t=e.message.messages).call(t,function(e,t){var r=n.renderSpecificMessage(e),o=e.message.response_type;return s.a.createElement("div",{className:v()("WAC__received--welcome-item",{"WAC__received--image":"image"===o,"WAC__received--options":"option"===o,"WAC__received--search":"search"===o,"WAC__received--suggestion":"suggestion"===o,"WAC__received--text":"text"===o,"WAC__received--welcome":"welcome"===o,"WAC__received--inlineError":"inline_error"===o,"WAC__received--previewAgent":"connect_to_agent"===o&&a}),key:t},r)}))},t.prototype.renderConnectToAgent=function(e){var t=this.props,n=t.languagePack,a=t.actions,r=t.isPreviewLink,o=t.agentState,i=t.requestInputFocus;return s.a.createElement(ie,{actions:a,localMessage:e,languagePack:n,isPreviewLink:r,agentState:o,requestInputFocus:i})},t.prototype.render=function(){return this.renderSpecificMessage(this.props.rootMessage)},t}(o.Component);var Ge=function(e){var t=e.width,n=e.height;return s.a.createElement("svg",{width:t||"24px",height:n||"24px",viewBox:"0 0 24 24",focusable:"false","aria-hidden":"true"},s.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"#171717",fillRule:"evenodd"},s.a.createElement("path",{d:"M12,1.5 C6.20101013,1.5 1.5,6.20101013 1.5,12 C1.5,17.7989899 6.20101013,22.5 12,22.5 C17.7989899,22.5 22.5,17.7989899 22.5,12 C22.5,9.21522686 21.3937532,6.54451077 19.4246212,4.5753788 C17.4554892,2.60624682 14.7847731,1.5 12,1.5 Z M7.5,19.785 L7.5,18.285 C7.42732658,16.9657523 8.43145297,15.8344366 9.75,15.75 L14.25,15.75 C15.5716397,15.8344008 16.5769538,16.9704058 16.5,18.2925 L16.5,19.7925 C13.7195993,21.4158274 10.2804007,21.4158274 7.5,19.7925 L7.5,19.785 Z M18,18.69 L18,18.2325 C18.0465935,16.1039517 16.3775025,14.331377 14.25,14.25 L9.75,14.25 C7.62249753,14.331377 5.95340646,16.1039517 6,18.2325 L6,18.6975 C3.21867096,16.2098037 2.26095127,12.263803 3.59244877,8.77789726 C4.92394627,5.29199155 8.26845552,2.98929607 12,2.98929607 C15.7315445,2.98929607 19.0760537,5.29199155 20.4075512,8.77789726 C21.7390487,12.263803 20.781329,16.2098037 18,18.6975 L18,18.69 Z M12,5.25 C9.92893219,5.25 8.25,6.92893219 8.25,9 C8.25,11.0710678 9.92893219,12.75 12,12.75 C14.0710678,12.75 15.75,11.0710678 15.75,9 C15.75,8.00543816 15.3549118,7.05161099 14.6516504,6.34834957 C13.948389,5.64508815 12.9945618,5.25 12,5.25 Z M12,11.25 C10.7573593,11.25 9.75,10.2426407 9.75,9 C9.75,7.75735931 10.7573593,6.75 12,6.75 C13.2426407,6.75 14.25,7.75735931 14.25,9 C14.25,9.5967371 14.0129471,10.1690334 13.5909903,10.5909903 C13.1690334,11.0129471 12.5967371,11.25 12,11.25 Z"})))},ze=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),Ze=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasError:!1},t.onAgentAvatarError=function(){t.setState({hasError:!0})},t}return ze(t,e),t.prototype.render=function(){var e,t=this.state.hasError,n=this.props,a=n.languagePack,r=n.avatarUrl,o=n.width,i=n.height;return e=!t&&r?s.a.createElement("img",{src:r,alt:a.agent_ariaAgentAvatar,onError:this.onAgentAvatarError}):s.a.createElement(Ge,{width:o,height:i,"aria-label":a.agent_ariaAgentAvatar}),s.a.createElement("div",{className:"WAC__agentAvatar"},e)},t}(o.PureComponent),Ke=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),Ye=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={errorOccurred:!1},t.ref=s.a.createRef(),t}return Ke(t,e),t.prototype.getWidgetSaidMessage=function(){var e=this.props,t=e.withHumanAgent,n=e.intl,a=e.botName,r=t?"messages_agentSaid":"messages_botSaid";return n.formatMessage({id:r},{botName:a})},t.prototype.scrollToTop=function(e){void 0===e&&(e=!1),Object($.c)(this.ref.current,e)},t.prototype.componentDidCatch=function(){this.setState({errorOccurred:!0})},t.prototype.renderErrorState=function(){return s.a.createElement("div",{className:"WAC__message WAC__message--inlineError",ref:this.ref},s.a.createElement("div",{className:"WAC__message--padding"},s.a.createElement("div",{className:"WAC__bot-message"},s.a.createElement(Q.a,null,this.getWidgetSaidMessage()),s.a.createElement("div",{className:"WAC__bot-bar"}),s.a.createElement("div",{className:"WAC__received WAC__received--text"},s.a.createElement(X,{text:this.props.languagePack.errors_singleMessage})))))},t.prototype.renderAvatar=function(e){var t=this.props,n=t.withHumanAgent,a=t.languagePack,r=!0;if(n)switch(e.message.response_type){case He.a.AGENT_JOINED:case He.a.TRANSFER_TO_AGENT:case He.a.USER_ENDED_CHAT:r=!1;break;default:r=!0}else r=e.ui_state.startMessageGroup;if(!r)return s.a.createElement("div",{className:"WAC__bot-bar--hidden"});if(n){var o=e.ui_state.agentProfile,i=o?o.profile_picture_url:null;return s.a.createElement("div",{className:"WAC__agentMessageAvatar"},s.a.createElement(Ze,{avatarUrl:i,languagePack:a,width:"24px",height:"24px"}))}return s.a.createElement("div",{className:"WAC__bot-bar"})},t.prototype.render=function(){if(this.state.errorOccurred)return this.renderErrorState();var e=this.props,t=e.actions,n=e.events,a=e.config,r=e.localMessage,o=e.languagePack,i=e.requestInputFocus,c=e.isPreviewLink,l=e.messagesIndex,u=e.hasServiceDesk,p=e.agentState,m=e.isProcess,g=e.processTitle,_=r.message.response_type,f=r.ui_state.type;if(q()(x.i).call(x.i,_)>-1)return!1;var d=r.ui_state.fromHistory,h=a.public.__ibm__.isProcessEnabled&&r.ui_state.process_launcher&&!m?s.a.createElement(K,{title:g,actions:t,languagePack:o}):s.a.createElement(qe,{actions:t,events:n,hasServiceDesk:u,isPreviewLink:c,languagePack:o,requestInputFocus:i,rootMessage:r,agentState:p}),C=qe.isValidType(r,u,c);return s.a.createElement("div",{id:"WAC__message-"+l,className:v()("WAC__message",{"WAC__message--custom":!C,"WAC__message--welcome":"welcome"===_,"WAC__message--disabled-inputs":d}),ref:this.ref},s.a.createElement("div",{className:"WAC__message--padding"},"output"===f&&s.a.createElement("div",{className:"WAC__bot-message"},s.a.createElement(Q.a,null,this.getWidgetSaidMessage()),this.renderAvatar(r),s.a.createElement("div",{className:v()("WAC__received",{"WAC__received--image":"image"===_,"WAC__received--options":"option"===_,"WAC__received--search":"search"===_,"WAC__received--suggestion":"suggestion"===_,"WAC__received--text":"text"===_,"WAC__received--welcome":"welcome"===_,"WAC__received--inlineError":"inline_error"===_,"WAC__received--previewAgent":"connect_to_agent"===_&&c,"WAC__received--agentStatusMessage":_===He.a.AGENT_JOINED||_===He.a.TRANSFER_TO_AGENT||_===He.a.USER_ENDED_CHAT,"WAC__message--historical":r.history&&r.history.fromHistory})},h)),"input"===f&&s.a.createElement("div",{className:"WAC__sent"},s.a.createElement(Q.a,null,o.messages_youSaid),h)))},t}(o.PureComponent),Je=Object(d.injectIntl)(Ye,{forwardRef:!0}),Xe=n(70),Qe=n.n(Xe);var $e=function(e){var t=e.timestamp;return s.a.createElement("div",{className:"WAC__date"},Qe()(t).format("LLLL"))};function et(e){return null==e}var tt=n(82),nt=n.n(tt),at=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),rt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isMounted:!1},t.onceAnnounced=!1,t}return at(t,e),t.prototype.componentDidMount=function(){this.setState({isMounted:!0})},t.prototype.render=function(){var e=this;return s.a.createElement("div",{"aria-live":"polite"},this.state.isMounted&&s.a.createElement(C.c,null,function(t){var n=t.announcePolite;return e.onceAnnounced||(e.props.announceOnce&&nt()(function(){n(e.props.announceOnce)}),e.onceAnnounced=!0),e.props.children}))},t}(o.PureComponent),ot=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),st=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCancelClick=function(){t.props.agentService.endChat()},t}return ot(t,e),t.prototype.render=function(){var e,t,n=this.props,a=n.availability,r=n.intl.messages.agent_ariaConnectingCancel;return a&&!et(a.estimated_wait_time)?(e="agent_connectingMinutes",t={time:a.estimated_wait_time}):a&&!et(a.position_in_queue)?(e="agent_connectingQueue",t={position:a.position_in_queue}):(e="agent_connecting",t={}),s.a.createElement("div",{className:"WAC__agentBanner"},s.a.createElement("div",{className:"WAC__agentBanner-text"},s.a.createElement(rt,{announceOnce:r},s.a.createElement(d.FormattedHTMLMessage,{id:e,values:t}))),s.a.createElement("div",{className:"WAC__agentBanner-buttonContainer"},s.a.createElement("button",{type:"button",className:"WAC__agentBanner-button WAC__button--base WAC__button--primary","aria-label":r,onClick:this.onCancelClick},s.a.createElement(d.FormattedMessage,{id:"buttons_cancel"}))))},t}(s.a.PureComponent);var it=Object(d.injectIntl)(Object(l.b)(function(e){return{availability:e.agentState.availability,agentService:e.actions.humanAgentService}})(st)),ct=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),lt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ct(t,e),t.prototype.render=function(){var e,t=this.props,n=t.message,a=t.languagePack,r=t.onToggleAgentView,o=n.ui_state.agentProfile?n.ui_state.agentProfile.profile_picture_url:null;e=n.message.response_type===He.a.AGENT_JOINED||n.message.response_type===He.a.TRANSFER_TO_AGENT?Ue(this.props.intl,n):n.message.text;var i=this.props.intl.formatMessage({id:"agent_ariaAgentNewMessage"},{messageText:e});return s.a.createElement(rt,null,s.a.createElement("div",{className:"WAC__agentBanner WAC__agentMessageBanner"},s.a.createElement(Ze,{languagePack:a,avatarUrl:o,height:"24px",width:"24px"}),s.a.createElement(C.b,{message:i,"aria-live":"polite"}),s.a.createElement("div",{className:"WAC__agentBanner-text"},s.a.createElement("div",{className:"WAC__agentBanner-textInner"},s.a.createElement("button",{type:"button",className:"WAC__agentMessageBanner-textButton WAC__button--link WACWidget__textEllipsis",onClick:r,"aria-label":a.agent_ariaToggleViewBot},e)))))},t}(s.a.PureComponent),ut=Object(d.injectIntl)(lt),pt=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),mt=function(){return(mt=b.a||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},gt=".WACWidget .WAC__messagesEndChatPadding{right:"+$.a+" !important;width:calc(100% - "+$.a+") !important}";var _t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.messageRefs=[],t.isTypingRef=s.a.createRef(),t.debouncedScroll=U()(function(){t.scrollToLastMessage(!0)},200),t}return pt(t,e),t.prototype.componentDidUpdate=function(e){e.messageIDs.length===this.props.messageIDs.length&&e.isTyping===this.props.isTyping||this.debouncedScroll()},t.prototype.scrollToLastMessage=function(e){if(void 0===e&&(e=!1),this.isTypingRef.current)Object($.c)(this.isTypingRef.current,e);else if(this.messageRefs.length){var t=this.messageRefs[this.messageRefs.length-1];t&&t.scrollToTop(e)}},t.prototype.conditionallyShowMessage=function(e,t){var n=this,a=this.props,r=a.actions,i=a.events,c=a.config,l=a.languagePack,u=a.requestInputFocus,p=a.isPreviewLink,m=a.hasServiceDesk,g=a.withHumanAgent,_=a.agentState,f=a.isProcess,d=a.botName,h=a.messageIDs,v=a.messagesByID,C=Object(x.d)(e);return(f||!e.ui_state.in_process||e.ui_state.type!==He.c.INPUT&&!C)&&(e.ui_state.type!==He.c.INPUT||"text"!==e.message.response_type||e.message.text)?e.ui_state.isNewWelcomeNode&&h[t+1]&&v[h[t+1]].ui_state.type===He.c.OUTPUT&&v[h[t+1]].ui_state.isNewWelcomeNode?null:s.a.createElement(o.Fragment,{key:t},s.a.createElement(Je,{ref:function(e){n.messageRefs[t]=e},events:i,config:c,localMessage:e,languagePack:l,requestInputFocus:u,actions:r,isPreviewLink:p,messagesIndex:t,hasServiceDesk:m,withHumanAgent:g,agentState:_,isProcess:f,processTitle:C,botName:d}),this.shouldShowDate(t)&&s.a.createElement($e,{timestamp:e.history.timestamp})):null},t.prototype.shouldShowDate=function(e){var t=this.props,n=t.messageIDs,a=t.messagesByID,r=a[n[e+1]],o=a[n[e]];return!!function(e,t){return!!(e&&e.ui_state&&e.ui_state.date&&t&&t.ui_state&&t.ui_state.date)}(o,r)&&o.ui_state.date!==r.ui_state.date},t.prototype.renderAgentConnectingBanner=function(){return this.props.agentState.isConnecting&&s.a.createElement(it,mt({},this.props.agentState))},t.prototype.renderAgentMessageBanner=function(){var e=this.props,t=e.agentState,n=e.withHumanAgent,a=e.languagePack,r=e.onToggleAgentView;return!n&&t.lastUnreadMessage&&s.a.createElement(ut,{message:t.lastUnreadMessage,languagePack:a,onToggleAgentView:r})},t.prototype.renderEndChat=function(){var e=this.props,t=e.agentState,n=e.withHumanAgent,a=e.languagePack,r=e.onConfirmEndChat;return n&&(t.isConnected||t.isConnecting)?s.a.createElement("div",{className:"WAC__messagesEndChatPadding"},s.a.createElement("style",null,gt),s.a.createElement("div",{className:"WAC__messagesEndChatContainer"},s.a.createElement("button",{type:"button",className:"WAC__messagesEndChatButton WAC__button",onClick:r},a.agent_endChat))):null},t.prototype.render=function(){var e=this,t=this.props,n=t.messageIDs,a=t.messagesByID,r=t.isTyping,o=t.withHumanAgent,i=t.intl,c=t.botName;this.messageRefs.length=n.length;var l,u=this.renderEndChat();if(r){var p=o?"messages_agentIsTyping":"messages_botIsTyping";l=i.formatMessage({id:p},{botName:c})}return s.a.createElement("div",{id:"WAC__messages-holder",className:"WAC__messages-holder"},this.renderAgentConnectingBanner(),this.renderAgentMessageBanner(),s.a.createElement("div",{id:"WAC__messages",className:v()("WAC__messages",{WAC__messagesWithEndChat:Boolean(u)}),"aria-live":"polite"},H()(n).call(n,function(t,n){return e.conditionallyShowMessage(a[t],n)}),r&&s.a.createElement("div",{className:"WAC__message",ref:this.isTypingRef},l&&s.a.createElement(C.b,{message:l,"aria-live":"polite"}),s.a.createElement("div",{className:"WAC__bot-message"},s.a.createElement("div",{className:"WAC__bot-bar--hidden"}),s.a.createElement("div",{className:"WAC__received--loading"},s.a.createElement(j,null))))),u)},t}(o.PureComponent),ft=Object(l.b)(function(e){return e},null,null,{forwardRef:!0})(_t),dt=function(){return(dt=b.a||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},ht=function(e){return s.a.createElement("svg",dt({},e,{focusable:"false",preserveAspectRatio:"xMidYMid meet",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32","aria-hidden":"true",style:{willChange:"transform"}}),s.a.createElement("path",{d:"M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4l6.6 6.6L8 22.6 9.4 24l6.6-6.6 6.6 6.6 1.4-1.4-6.6-6.6L24 9.4z"}))},vt=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),Ct=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonRef=s.a.createRef(),t.localOnClose=function(){(0,t.props.onClose)();t.props.actions.track({eventName:"Widget_closes",eventDescription:"user closes the widget",method:"x button"})},t}return vt(t,e),t.prototype.requestFocus=function(){this.buttonRef.current&&this.buttonRef.current.focus()},t.prototype.render=function(){var e=this.props.languagePack;return s.a.createElement("div",{className:"WAC__headerButtonContainer"},s.a.createElement("button",{ref:this.buttonRef,className:"WAC__header-close WAC__headerButton",id:"WAC__header-close","aria-label":e.launcher_isOpen,onClick:this.localOnClose,type:"button"},s.a.createElement(ht,null)))},t}(o.PureComponent);var Et=function(){return s.a.createElement("svg",{viewBox:"0 0 20 20",focusable:"false","aria-hidden":"true"},s.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},s.a.createElement("g",{transform:"translate(-925.000000, -131.000000)",fill:"#171717"},s.a.createElement("g",{transform:"translate(635.000000, 117.000000)"},s.a.createElement("path",{d:"M301.884786,34 L300.714286,33.1810714 L304.142857,28.2857143 L308.085714,28.2857143 C308.353967,28.2857143 308.571429,28.0682526 308.571429,27.8 L308.571429,27.8 L308.571429,19.4857143 C308.571192,19.2175596 308.353869,19.0002363 308.085714,19 L295.485714,19 C295.217625,19.0003934 295.000393,19.2176248 295,19.4857143 L295,27.8 C295.000236,28.0681547 295.21756,28.285478 295.485714,28.2857143 L301.428571,28.2857143 L301.428571,29.7142857 L295.485714,29.7142857 C294.428957,29.7131441 293.57257,28.8567576 293.571429,27.8 L293.571429,19.4857143 C293.57261,18.428973 294.428973,17.5726095 295.485714,17.5714286 L308.085714,17.5714286 C309.142472,17.5725702 309.998858,18.4289567 310,19.4857143 L310,27.8 C309.998898,28.8567739 309.142488,29.7131833 308.085714,29.7142857 L304.886286,29.7142857 L301.884786,34 Z M291.428571,25.4285714 L290,25.4285714 L290,15.9142857 C290.001181,14.8575445 290.857544,14.0011809 291.914286,14 L301.428571,14 L301.428571,15.4285714 L291.914286,15.4285714 C291.646196,15.4289648 291.428965,15.6461962 291.428571,15.9142857 L291.428571,25.4285714 Z"})))))},yt=s.a.createContext(null),At=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),bt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={attachedToHost:null},t.modalElement=document.createElement("div"),t}return At(t,e),t.prototype.componentDidMount=function(){this.attachIfNeeded()},t.prototype.componentDidUpdate=function(){this.attachIfNeeded()},t.prototype.componentWillUnmount=function(){this.state.attachedToHost&&this.state.attachedToHost.removeChild(this.modalElement)},t.prototype.attachIfNeeded=function(){var e=this.context;e&&!this.state.attachedToHost&&(this.setState({attachedToHost:e}),e.appendChild(this.modalElement))},t.prototype.render=function(){return this.state.attachedToHost?c.a.createPortal(this.props.children,this.modalElement):null},t.contextType=yt,t}(o.Component),wt=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),Wt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={renderTooltip:!1,allowAutoShow:t.props.withHumanAgent},t}return wt(t,e),t.prototype.componentDidMount=function(){this.doUpdate(!1)},t.prototype.componentDidUpdate=function(e){this.doUpdate(e.mouseOverTarget)},t.prototype.doUpdate=function(e){var t=this,n=!1,a=!1;if(this.props.agentState.isPanelOpen!==this.props.withHumanAgent)n=!1;else if(this.props.mouseOverTarget&&!this.state.renderTooltip)n=!0;else if(e&&!this.props.mouseOverTarget)n=!1;else{if(this.state.renderTooltip||!this.state.allowAutoShow)return;n=!0,a=!0}n&&!this.state.renderTooltip?(this.setState({renderTooltip:!0,allowAutoShow:!1}),a&&nt()(function(){t.setState({renderTooltip:!1})},5e3)):!n&&this.state.renderTooltip&&this.setState({renderTooltip:!1})},t.prototype.render=function(){var e,t=this.props,n=t.botName,a=t.intl;e=t.withHumanAgent?"agent_ariaToggleViewAgent":"agent_ariaToggleViewBot";var r=a.formatMessage({id:e},{botName:n});return this.state.renderTooltip&&s.a.createElement(bt,null,s.a.createElement("div",{className:"WACModal__backToBotTooltip"},s.a.createElement("div",{className:"WACModal__backToBotTooltipSizer"},s.a.createElement("div",{className:"WACModal__backToBotTooltipPadding"}),s.a.createElement("div",{className:"WACModal__backToBotTooltipBubbleContainer"},s.a.createElement("div",{className:"WACModal__backToBotTooltipBubble"},s.a.createElement("div",{className:"WACModal__backToBotTooltipText WACWidget__breakWord"},r)))),s.a.createElement("div",{className:"WACModal__backToBotTooltipArrow"},s.a.createElement("div",{className:"WACModal__backToBotTooltipArrowPointer"}))))},t}(o.PureComponent),Nt=Object(d.injectIntl)(Wt),Tt=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),kt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={mouseOverBackToBot:!1},t.closeRef=s.a.createRef(),t.onMouseOverBackToBotButton=function(){t.setState({mouseOverBackToBot:!0})},t.onMouseOutBackToBotButton=function(){t.setState({mouseOverBackToBot:!1})},t}return Tt(t,e),t.prototype.requestCloseFocus=function(){this.closeRef.current&&this.closeRef.current.requestFocus()},t.prototype.renderBotName=function(){var e=this.props.botName,t=void 0===e?null:e;return s.a.createElement("div",{id:"WAC__header-name",className:"WAC__header-name"},t)},t.prototype.renderAgentInfo=function(e){var t,n=this.props.languagePack,a=e.agentProfile,r=a?a.profile_picture_url:null;a&&(t=a.nickname||a.full_name),t||(t=n.agent_agentNoNameTitle);var o=e.isConnected,i=o?n.agent_ariaAgentConnected:n.agent_ariaAgentNotConnected;return s.a.createElement("div",{className:"WAC__headerAgentInfo"},s.a.createElement(Ze,{avatarUrl:r,languagePack:n,width:"32px",height:"32px"}),s.a.createElement("div",{className:"WACWidget__textEllipsis"},t),s.a.createElement("div",{className:v()("WAC__headerAgentOnlineStatus",{"WAC__headerAgentOnlineStatus--offline":!o}),title:i}))},t.prototype.renderAgentChatButton=function(){var e,t=this.props,n=t.languagePack,a=t.withHumanAgent,r=t.onToggleAgentView,o=t.agentState,i=t.intl,c=t.botName,l=o.numUnreadMessages,u=!a&&0!==l;return a?e=i.formatMessage({id:"agent_ariaToggleViewAgent"},{botName:c}):(e=n.agent_ariaToggleViewBot,u&&(e+=". "+i.formatMessage({id:"icon_ariaUnreadMessages"},{count:l}))),s.a.createElement("div",{className:"WAC__headerButtonContainer"},s.a.createElement("button",{type:"button",className:"WAC__headerButton",onClick:r,onMouseOver:this.onMouseOverBackToBotButton,onMouseOut:this.onMouseOutBackToBotButton,"aria-label":e},s.a.createElement(Et,null)),u&&s.a.createElement("div",{className:"WAC__countIndicator"},l))},t.prototype.render=function(){var e=this.props,t=e.actions,n=e.languagePack,a=e.onToggleOpen,r=e.showCloseButton,o=e.agentState,i=e.withHumanAgent,c=e.botName,l=o.wasConnected;return s.a.createElement("div",{id:"WAC__header",className:"WAC__header"},!i&&this.renderBotName(),s.a.createElement(Nt,{withHumanAgent:i,agentState:o,botName:c,languagePack:n,mouseOverTarget:this.state.mouseOverBackToBot}),i&&this.renderAgentInfo(o),s.a.createElement("div",{className:"WAC__headerButtons"},l&&this.renderAgentChatButton(),r&&s.a.createElement(Ct,{ref:this.closeRef,actions:t,languagePack:n,onClose:a})))},t}(o.PureComponent),Pt=Object(d.injectIntl)(kt,{forwardRef:!0}),Ot=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),Rt=function(e){function t(t){var n=e.call(this,t)||this;return n.close=function(){n.setState({isClosing:!0}),nt()(n.props.onClose,500)},n.state={isClosing:!1},n}return Ot(t,e),t.prototype.render=function(){var e=this.props,t=e.children,n=e.title,a=this.state.isClosing;return s.a.createElement("div",{className:v()("WAC__overlay-panel",{"WAC__overlay-panel--closing":a})},s.a.createElement("header",{className:"WAC__header"},s.a.createElement("button",{type:"button",className:"WAC__headerButton",onClick:this.close},s.a.createElement("svg",{className:"WAC__header-closeSVG",preserveAspectRatio:"xMidYMid meet",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 32 32","aria-hidden":"true"},s.a.createElement("path",{d:"M13 26l1.41-1.41L6.83 17H29v-2H6.83l7.58-7.59L13 6 3 16l10 10z"}))),s.a.createElement("span",{className:"WAC__header-name"},n)),t)},t}(o.PureComponent),St=n(154),Lt=n.n(St),Mt=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),xt=function(){return(xt=b.a||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};var It=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.messageRefs=[],t.isTypingRef=s.a.createRef(),t.debouncedScroll=U()(function(){t.scrollToLastMessage(!0)},200),t}return Mt(t,e),t.prototype.componentDidUpdate=function(e){e.messages.length!==this.props.messages.length&&this.debouncedScroll()},t.prototype.scrollToLastMessage=function(e){if(void 0===e&&(e=!1),this.isTypingRef.current)Object($.c)(this.isTypingRef.current,e);else if(this.messageRefs.length){var t=this.messageRefs[this.messageRefs.length-1];t&&t.scrollToTop(e)}},t.prototype.conditionallyShowMessage=function(e,t,n){var a=this,r=this.props,i=r.actions,c=r.events,l=r.config,u=r.languagePack,p=r.requestInputFocus,m=r.isPreviewLink,g=r.hasServiceDesk,_=r.agentState,f=r.processTitle,d=r.botName;return"input"!==e.ui_state.type||"text"!==e.message.response_type||e.message.text?s.a.createElement(o.Fragment,{key:t},s.a.createElement(Je,{ref:function(e){a.messageRefs[t]=e},events:c,config:l,localMessage:e,languagePack:u,requestInputFocus:p,actions:i,isPreviewLink:m,messagesIndex:t,hasServiceDesk:g,isProcess:!0,withHumanAgent:!1,agentState:_,processTitle:f,botName:d}),this.shouldShowDate(n,t)&&s.a.createElement($e,{timestamp:e.history.timestamp})):null},t.prototype.shouldShowDate=function(e,t){var n=function(e,t){return e[t+1]||null}(e,t),a=e[t];return!!function(e,t){return!!(e&&e.ui_state&&e.ui_state.date&&t&&t.ui_state&&t.ui_state.date)}(a,n)&&a.ui_state.date!==n.ui_state.date},t.prototype.renderAgentConnectingBanner=function(){return this.props.agentState.isConnecting&&s.a.createElement(it,xt({},this.props.agentState))},t.prototype.renderAgentMessageBanner=function(){var e=this.props,t=e.agentState,n=e.withHumanAgent,a=e.languagePack,r=e.onToggleAgentView;return!n&&t.lastUnreadMessage&&s.a.createElement(ut,{message:t.lastUnreadMessage,languagePack:a,onToggleAgentView:r})},t.prototype.render=function(){var e=this,t=this.props,n=t.messages,a=t.isTyping;return this.messageRefs.length=n.length,s.a.createElement("div",{id:"WAC__messages-holder",className:"WAC__messages-holder"},this.renderAgentConnectingBanner(),this.renderAgentMessageBanner(),s.a.createElement("div",{id:"WAC__messages",className:"WAC__messages","aria-live":"polite"},H()(n).call(n,function(t,a){return e.conditionallyShowMessage(t,a,n)}),a&&s.a.createElement("div",{className:"WAC__message",ref:this.isTypingRef},s.a.createElement("div",{className:"WAC__bot-message"},s.a.createElement("div",{className:"WAC__bot-bar--hidden"}),s.a.createElement("div",{className:"WAC__received--loading"},s.a.createElement(j,null))))))},t}(o.PureComponent),Bt=Object(l.b)(function(e){return e},null,null,{forwardRef:!0})(It);function Dt(e,t){return H()(e).call(e,function(e){return t[e]})}var Ht=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),Ft=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputRef=s.a.createRef(),t.onSendBotInput=function(e){var n=Object(x.b)(e);t.props.actions.send(n,{trackEventProps:{eventName:"User_gives_dialog_input",eventDescription:"dialog event for user giving input to bot",responseType:"text"}})},t}return Ht(t,e),t.prototype.componentDidMount=function(){var e,t=this,n=this.props.botMessageState,a=n.messageIDs,r=n.messagesByID,o=Lt()(e=Dt(a,r)).call(e,function(e){return e.ui_state.in_process===t.props.title});this.setState({messages:o,messageCount:o.length})},t.getDerivedStateFromProps=function(e,t){if(!t)return null;var n,a=t&&t.messages?t.messages.length:0,r=t&&t.messageCount?t.messageCount:0;return e.botMessageState.messageIDs.length>r?{messages:Ee()(n=Dt(e.botMessageState.messageIDs,e.botMessageState.messagesByID)).call(n,e.botMessageState.messages.length-1-a),messageCount:e.botMessageState.messageIDs.length}:null},t.prototype.render=function(){if(!this.state)return null;var e=this.props,t=e.actions,n=e.config,a=e.isPreviewLink,r=e.languagePack,i=e.requestInputFocus,c=e.hasServiceDesk,l=e.isTyping,u=e.processTitle,p=e.onToggleAgentView,m=e.botName,g=this.state.messages,_=g&&g.length>0&&g[g.length-1].context&&!Object(x.d)(g[g.length-1]);return s.a.createElement(o.Fragment,null,s.a.createElement("div",{className:"WAC__process-wizard"},s.a.createElement(Bt,{config:n,messages:g,requestInputFocus:i,hasServiceDesk:c,isPreviewLink:a,isTyping:l,processTitle:u,withHumanAgent:!1,onToggleAgentView:p,botName:m}),!_&&s.a.createElement(B,{languagePack:r,actions:t,disabled:!1,ref:this.inputRef,onSendInput:this.onSendBotInput})))},t}(o.PureComponent),Ut=Object(l.b)(function(e){return e},null,null,{forwardRef:!0})(Ft),jt=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),Vt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.noButtonRef=s.a.createRef(),t.onYesClick=function(){t.props.actions.humanAgentService.endChat(),t.props.onConfirmClose()},t.onNoClick=function(){t.props.onConfirmClose()},t.onKeyDown=function(e){"Escape"===e.key&&t.props.onConfirmClose()},t}return jt(t,e),t.prototype.componentDidMount=function(){this.noButtonRef.current&&this.noButtonRef.current.focus()},t.prototype.render=function(){var e=this.props.languagePack;return s.a.createElement("div",{className:"WACAgentConfirmEndChat"},s.a.createElement("div",{className:"WACAgentConfirmEndChat__container"},s.a.createElement(C.b,{message:e.agent_confirmEndChat,"aria-live":"polite"}),s.a.createElement("div",{className:"WACAgentConfirmEndChat__title"},e.agent_endChat),s.a.createElement("div",{className:"WACAgentConfirmEndChat__message"},e.agent_confirmEndChat),s.a.createElement("div",{className:"WACAgentConfirmEndChat__buttonContainer"},s.a.createElement("button",{type:"button",className:"WAC__button--base WAC__button--ghost",ref:this.noButtonRef,onClick:this.onNoClick,onKeyDown:this.onKeyDown,"aria-label":e.agent_ariaConfirmEndChatNo},e.agent_confirmEndChatNo),s.a.createElement("button",{type:"button",className:"WAC__button--base WAC__button--primary",onClick:this.onYesClick,onKeyDown:this.onKeyDown,"aria-label":e.agent_ariaConfirmEndChatYes},e.agent_confirmEndChatYes))))},t}(o.Component),qt=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),Gt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={showEndChatConfirmation:!1},t.inputRef=s.a.createRef(),t.headerRef=s.a.createRef(),t.messagesRef=s.a.createRef(),t.hideConfirmEndChat=function(){t.setState({showEndChatConfirmation:!1}),t.requestInputFocus()},t.showConfirmEndChat=function(){t.setState({showEndChatConfirmation:!0})},t.requestInputFocus=function(){var e=t.props,n=e.withHumanAgent,a=e.agentState;!(n&&!a.isConnected)&&t.inputRef.current?t.inputRef.current.takeFocus():t.headerRef.current&&t.headerRef.current.requestCloseFocus()},t}return qt(t,e),t.prototype.componentDidUpdate=function(e){this.props.isVisible&&!e.isVisible&&this.requestInputFocus()},t.prototype.getBotName=function(){var e=this.props,t=e.languagePack,n=e.config,a=e.isPreviewLink,r=n.remote.botName,o=n.public.__ibm__.botNameOverride,s=a?t.header_previewLinkTitle:r;return o||s},t.prototype.scrollToLastMessage=function(e){void 0===e&&(e=!1),this.messagesRef.current&&this.messagesRef.current.scrollToLastMessage(e)},t.prototype.render=function(){var e=this.props,t=e.actions,n=e.languagePack,a=e.hasServiceDesk,r=e.isPreviewLink,o=e.showCloseButton,i=e.onToggleOpen,c=e.onToggleAgentView,l=e.withHumanAgent,u=e.onSendInput,p=e.messageState,m=e.agentState,g=e.processTitle,_=e.isProcessOpen,f=e.intl,d=p.messageIDs,h=p.messagesByID,v=p.isTyping,C=l&&!m.isConnected,E=this.getBotName();return s.a.createElement("div",{className:"WAC"},s.a.createElement(Pt,{ref:this.headerRef,actions:t,botName:E,languagePack:n,showCloseButton:o,onToggleOpen:i,onToggleAgentView:c,agentState:m,withHumanAgent:l}),s.a.createElement("div",{className:"WAC__messagesAndInputContainer"},s.a.createElement(ft,{hasServiceDesk:a,ref:this.messagesRef,messageIDs:d,messagesByID:h,isTyping:v,requestInputFocus:this.requestInputFocus,isPreviewLink:r,withHumanAgent:l,onToggleAgentView:c,onConfirmEndChat:this.showConfirmEndChat,botName:E,intl:f}),s.a.createElement(B,{languagePack:n,actions:t,disabled:C,ref:this.inputRef,onSendInput:u}),l&&this.state.showEndChatConfirmation&&s.a.createElement(Vt,{languagePack:n,onConfirmClose:this.hideConfirmEndChat,actions:t})),_&&s.a.createElement(Rt,{title:g,onClose:function(){return t.closeProcess()}},s.a.createElement(Ut,{actions:t,title:g,requestInputFocus:this.requestInputFocus,hasServiceDesk:a,isPreviewLink:r,isTyping:v,onToggleAgentView:c,botName:E})))},t}(o.Component),zt=Object(d.injectIntl)(Gt,{forwardRef:!0}),Zt=n(69);var Kt=Object(d.injectIntl)(function(e){var t=e.announcement,n=e.intl,a="";return t&&(a=t.messageId?n.formatMessage({id:t.messageId},t.messageValues):t.messageText),s.a.createElement(C.b,{message:a,"aria-live":"polite"})}),Yt=function(){var e=function(t,n){return(e=f.a||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?g()(n):(a.prototype=n.prototype,new a)}}(),Jt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={closing:!1,open:!t.props.config||!t.props.config.public.showLauncher||t.props.isOpen,openedOnce:!t.props.config||!t.props.config.public.showLauncher||t.props.isOpen,modalPortalHostElement:null},t.containerRef=s.a.createRef(),t.botChatRef=s.a.createRef(),t.agentChatRef=s.a.createRef(),t.launcherRef=s.a.createRef(),t.setModalPortalHostElement=function(e){t.state.modalPortalHostElement!==e&&t.setState({modalPortalHostElement:e})},t.onSendBotInput=function(e){var n=Object(x.b)(e);t.props.actions.send(n,{trackEventProps:{eventName:"User_gives_dialog_input",eventDescription:"dialog event for user giving input to bot",responseType:"text"}})},t.onSendAgentInput=function(e){t.props.actions.humanAgentService.sendMessageToAgent(e)},t.removeChatFromDom=function(){t.containerRef.current.removeEventListener("animationend",t.removeChatFromDom),t.setState({open:!1,closing:!1})},t.onToggleOpen=function(){t.props.actions.toggleOpen(),t.doDefaultFocus()},t.onToggleAgentView=function(){t.props.setPanelOpen(!t.props.agentState.isPanelOpen),t.doDefaultFocus()},t}return Yt(t,e),t.prototype.componentDidMount=function(){this.scrollToLastMessage(!1)},t.prototype.componentDidUpdate=function(e,t){var n=this,a=this.props,r=a.isOpen,o=a.config.public,s=this.state.open;!(o&&o.showLauncher&&r)||e.isOpen&&s?o&&o.showLauncher&&!r&&e.isOpen&&t.open&&s&&(this.setState({closing:!0}),this.containerRef.current.addEventListener("animationend",this.removeChatFromDom)):this.setState({open:!0,openedOnce:!0},function(){n.scrollToLastMessage(!1)})},t.prototype.doDefaultFocus=function(){this.props.isOpen?this.props.agentState.isPanelOpen?this.agentChatRef.current&&this.agentChatRef.current.requestInputFocus():this.botChatRef.current&&this.botChatRef.current.requestInputFocus():this.launcherRef.current&&this.launcherRef.current.requestFocus()},t.prototype.scrollToLastMessage=function(e){void 0===e&&(e=!1),this.botChatRef.current&&this.botChatRef.current.scrollToLastMessage(e),this.agentChatRef.current&&this.agentChatRef.current.scrollToLastMessage(e)},t.prototype.renderChat=function(){var e=this.props,t=e.actions,n=e.config,a=e.hasServiceDesk,r=e.languagePack,i=e.uuid,c=e.botMessageState,l=e.agentState,u=e.isProcessOpen,p=e.processTitle,m=l.isPanelOpen,g=n.public.__ibm__.isPreviewLink,_=n.public,f=_&&_.showLauncher;return s.a.createElement(o.Fragment,null,s.a.createElement("div",{className:v()("WACBotContainer",{WAC__hidden:m})},s.a.createElement(zt,{ref:this.botChatRef,languagePack:r,config:n,actions:t,isPreviewLink:g,hasServiceDesk:a,uuid:i,showCloseButton:f,onToggleOpen:this.onToggleOpen,onToggleAgentView:this.onToggleAgentView,withHumanAgent:!1,messageState:c,onSendInput:this.onSendBotInput,agentState:l,isProcessOpen:u,processTitle:p,isVisible:!m})),s.a.createElement("div",{className:v()("WACAgentContainer",{WAC__hidden:!m,"WACAgentContainer--open":m,"WACAgentContainer--closed":!m})},s.a.createElement(zt,{ref:this.agentChatRef,languagePack:r,config:n,actions:t,isPreviewLink:g,hasServiceDesk:a,uuid:i,showCloseButton:f,onToggleOpen:this.onToggleOpen,onToggleAgentView:this.onToggleAgentView,withHumanAgent:!0,messageState:l.agentMessageState,onSendInput:this.onSendAgentInput,agentState:l,isProcessOpen:!1,processTitle:"",isVisible:m})))},t.prototype.render=function(){var e=this.props,t=e.actions,n=e.config,a=e.isFixedDisplay,r=e.languagePack,o=e.shadowRoot,i=e.uuid,c=e.locale,l=e.agentState,u=e.announceMessage,p=this.state,m=p.closing,g=p.open,_=p.openedOnce,f=p.modalPortalHostElement,h=n.public;return s.a.createElement(d.IntlProvider,{locale:c,messages:r},s.a.createElement(E.a.Provider,{value:o},s.a.createElement(yt.Provider,{value:f},s.a.createElement(C.a,null,s.a.createElement(Kt,{announcement:u}),s.a.createElement("div",{id:"WACWidget",className:v()("WACWidget",{"WACWidget--fixed":a,"WACWidget--launched":!m&&h&&h.showLauncher,"WACWidget--closing":m&&h&&h.showLauncher,"WACWidget--closed":!g&&h&&h.showLauncher}),"aria-label":r.window_title,ref:this.containerRef},s.a.createElement("div",{className:"WACWidget__animationContainer"},_&&this.renderChat()),s.a.createElement("div",{className:"WACWidget__modalPortalHost",ref:this.setModalPortalHostElement})),h&&h.showLauncher&&s.a.createElement(P,{actions:t,ref:this.launcherRef,uuid:i,languagePack:r,isOpen:this.props.isOpen,onToggleOpen:this.onToggleOpen,unreadAgentCount:l.numUnreadMessages})))))},t}(o.Component),Xt=Object(l.b)(function(e){return e},{setPanelOpen:Zt.n})(Jt),Qt=n(727);p.setLogger(null);var $t=Object(u.createInstance)({sdkKey:"TnEXCTtScEApuT1VpPvHEq"});function en(e,t,n,a,r,o){var i=e.getState(),p=i.accountID,m=i.userID,g=i.sessionID,_=i.config.public.__ibm__.isPreviewLink,f=Object(N.a)(p,m,g);c.a.render(s.a.createElement(l.a,{store:e},s.a.createElement(u.OptimizelyProvider,{optimizely:$t,user:{id:f,attributes:{isPreviewLink:_}}},s.a.createElement(y.Provider,{value:{optimizely:$t,trackUserID:f,isServerSide:!1,isPreviewLink:_}},s.a.createElement(Xt,{isFixedDisplay:t,hasServiceDesk:n,shadowRoot:r,uuid:o})))),a)}Object(Qt.a)(en);t.default=en}}]);